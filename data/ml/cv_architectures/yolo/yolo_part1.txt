8. YOLO (доделать) 
1. Что такое YOLO и в чём её философия по сравнению с R-CNN
семейством? 
YOLO (You Only Look Once) — это семейство моделей одностадийных 
детекторов объектов (one-stage detectors), которые выполняют 
детекцию за один проход нейросети, напрямую предсказывая 
bounding box’ы и классы из всего изображения. 
�
� Философия YOLO 
YOLO рассматривает задачу детекции как задачу регрессии: 
Изображение → Сетка (grid) → Прямое предсказание координат, 
objectness и классов. 
То есть, вместо того чтобы сначала искать кандидаты регионов (region 
proposals), как делают R-CNN, YOLO сразу учится прогнозировать: 
• положение объектов (x, y, w, h), 
• вероятность существования объекта в ячейке (objectness), 
• вероятности классов. 
Это делает весь процесс end-to-end: 
модель получает пиксели — и сразу выдаёт финальные боксы и 
классы без промежуточных этапов. 
⚙
️ Сравнение с R-CNN-семейством 
Особенность 
Этапы 
Скорость 
Архитектура 
Обучение 
Точность 
мелких 
объектов 
R-CNN / Faster R-CNN 
Двухэтапный процесс:  
1) Region proposals, 2) 
Классификация и регрессия 
Медленнее (каждый регион 
проходит CNN) 
Сложная, много вспомогательных 
модулей (RPN, ROI Pooling) 
Часто не end-to-end 
Лучше у двухэтапных 
Использование Приоритет точности 
�
� Суть философии 
YOLO 
Одноэтапный: прямое 
предсказание bbox + 
классов 
Очень быстрая, ~30–100 
FPS 
Простая, единая CNN 
Полностью end-to-end 
YOLO хуже видит мелкие 
объекты (особенно в v1) 
Приоритет скорости 
(реальное время) 
YOLO жертвует частью точности ради универсальности, скорости и 
простоты. 
Она объединяет всё в один forward pass, убирает сложные 
пайплайны region proposals и ROI-пулингов, и учится видеть всю 
сцену целиком, а не по кускам. 
Этим YOLO закладывает новую парадигму — real-time object detection, 
где модель не просто точна, но и мгновенно реагирует. 
2. Как YOLO формулирует детекцию как задачу регрессии? 
YOLO превращает задачу детекции объектов — из сложной комбинации 
локализации + классификации + region proposal — в единую задачу регрессии, 
предсказываемую одной нейросетью. 
�
� Идея 
YOLO делит входное изображение размером S×S на сетку (обычно 13×13, 19×19 и 
т. д.). 
Каждая ячейка (grid cell) отвечает за обнаружение объектов, чьи центры 
попадают внутрь неё. 
Для каждой ячейки модель предсказывает: 
• координаты ограничивающего прямоугольника (x, y, w, h), 
• objectness — вероятность того, что в этой ячейке есть объект, 
• class probabilities — распределение вероятностей по всем классам. 
Все эти значения — не дискретные категории, а непрерывные переменные, 
поэтому YOLO обучается регрессировать их напрямую. 
⚙
️ Формализация (YOLOv1 концепция) 
Для каждой ячейки: 
Output=[x,y,w,h,Pobj ,p1 ,p2 ,...,pC ]  
Где: 
• (x,y) — смещение центра бокса относительно ячейки (в долях размера 
ячейки, [0,1]); 
• (w,h) — ширина и высота бокса, нормализованные относительно 
изображения; 
• Pobj  — вероятность наличия объекта в ячейке; 
• pi  — условная вероятность класса i, если объект есть. 
Финальная вероятность для класса i в ячейке: 
P(classi )=Pobj ×pi   
�
� Почему это регрессия 
Модель обучается минимизировать разницу между предсказанными и реальными 
значениями: 
• Координаты (x, y, w, h) — регрессионные величины → MSE или L1 loss. 
• Objectness и классы — вероятности → BCE/CE loss. 
То есть нейросеть не ищет объекты, а учится предсказывать непрерывные 
параметры, описывающие их положение и принадлежность классу. 
�
� Ключевая идея 
YOLO сводит задачу “где и что находится на изображении” к задаче “регрессии 
параметров прямоугольников и вероятностей классов” — всё в одной модели, 
одним forward-pass’ом. 
3. Что значит разбиение изображения на grid и что каждая ячейка 
предсказывает? 
�
� Суть идеи 
YOLO делит входное изображение размером W×H на равномерную 
сетку — grid из S×S ячеек. 
Например, при S=13 (YOLOv3 для входа 416×416) каждая ячейка 
отвечает за обнаружение объектов, чьи центры попадают внутрь 
неё. 
Такое разбиение позволяет перевести задачу “поиск объектов где 
угодно” → “регрессия относительно фиксированной сетки”. 
⚙
️ Что предсказывает каждая ячейка 
Каждая ячейка предсказывает: 
• B anchor-боксов (в YOLOv3 — обычно 3 на каждом уровне), 
• для каждого anchor — набор параметров: 
o tx ,ty ,tw ,th : смещения и масштаб (регрессионные 
параметры), 
o Pobj : вероятность, что этот anchor содержит объект, 
o P(classi ): вероятности классов (через BCE или softmax). 
Итого, для одной ячейки размерность выхода: 
B×(5+C)  
где: 
• 5 = (tx, ty, tw, th, objectness), 
• C = число классов. 
�
� Как YOLO использует координаты 
Для предсказанного anchor-а YOLO вычисляет финальные координаты 
бокса относительно ячейки: 
где: 
• (cx ,cy ) — координаты левого верхнего угла ячейки, 
• (pw ,ph ) — размеры anchor-бокса, 
• σ(⋅) — сигмоида, ограничивающая смещения в [0,1]. 
�
� Интерпретация 
• Каждая ячейка отвечает только за объекты, чьи центры 
попадают в неё, чтобы избежать дублирования предсказаний. 
• Если в ячейке нет объекта → модель учится предсказывать 
низкий objectness (≈ 0). 
• Если объект есть → она обучается корректировать anchor, чтобы 
получить точный bbox. 
�
� Главная идея 
YOLO заменяет поиск объектов на задачу регрессии по дискретной 
сетке: 
каждая ячейка “смотрит” на свой участок и решает — есть ли тут 
объект и если да, то какой и где он находится. 
4. Почему YOLO быстрее и проще, чем двухэтапные методы? 
⚙
️ Ключевая идея 
YOLO — это one-stage detector, то есть она выполняет все стадии 
детекции (локализация + классификация) за один прямой проход 
нейросети (forward pass). 
Двухэтапные методы (R-CNN, Fast/Faster R-CNN) работают иначе: 
они сначала ищут кандидатов регионов (region proposals), а потом 
классифицируют и уточняют каждый из них отдельно. 
�
� Детали различий 
Этап 
1. Region 
proposal 
2. Feature 
extraction 
3. 
Классифи
кация 
регионов 
4. 
Faster R-CNN 
Отдельная RPN (Region Proposal 
Network) ищет 100–2000 кандидатов 
CNN (ResNet, VGG) применяется ко 
всему изображению, потом ROI pooling 
для каждого региона 
Каждый регион классифицируется и 
уточняется отдельно 
Скорость 5–10 FPS (часто <1 FPS на CPU) 
5. 
Архитекту
ра 
Много стадий, раздельное обучение 
�
� Почему YOLO быстрее 
1. Один forward вместо двух: 
YOLO 
Отсутствует — YOLO сразу 
предсказывает bbox для 
каждой grid cell 
CNN применяется один 
раз ко всему изображению 
Классы и bbox 
регрессируются 
одновременно 
30–100+ FPS на GPU 
Единая end-to-end сеть 
YOLO не делает отдельный поиск регионов → меньше 
вычислений и I/O. 
2. Fully convolutional архитектура: 
Все операции — свёртки, без постобработки и feature cropping, 
что отлично параллелится на GPU. 
3. Предсказания для всех позиций одновременно: 
YOLO обрабатывает всю картинку как целое, не вырезая и не 
анализируя фрагменты. 
4. Отсутствие RPN и ROI Pooling: 
Нет узких мест, как в двухэтапных методах (каждый ROI нужно 
прогнать через head). 
�
� Почему проще 
• Меньше компонентов: один backbone + detection head. 
• Нет отдельных стадий обучения (RPN отдельно, classifier 
отдельно). 
• Проще дебажить, переносить, оптимизировать. 
• Легко масштабировать (добавить уровни feature map или 
anchors). 
�
� Ключевая мысль 
YOLO объединяет “что” и “где” в одну сеть, 
минимизируя вычисления и архитектурные блоки. 
Это делает её в разы быстрее и проще в реализации, 
при этом сохраняя конкурентную точность.