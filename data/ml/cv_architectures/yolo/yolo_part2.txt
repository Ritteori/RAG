5. Основные отличия YOLOv1, YOLOv2 и YOLOv3 (ключевые идеи). 
YOLOv1 (2016) 
• Формулирует детекцию как единую регрессию от изображения 
к координатам боксов и вероятностям классов. 
• Делит изображение на S×S grid, каждая ячейка предсказывает B 
боксов + C классов. 
• Проблемы: плохо работает с мелкими объектами, плохая 
локализация — каждая ячейка может предсказать только один 
объект. 
YOLOv2 (YOLO9000, 2017) 
• Улучшает точность, не теряя скорости. 
• Вводит Anchor Boxes (как в Faster R-CNN). 
• Использует BatchNorm для стабилизации. 
• Высокое разрешение входа (448×448 → 608×608). 
• Multi-scale training — сеть учится работать на разных размерах. 
• Улучшает баланс точности/скорости, но всё ещё страдает при 
детекции очень мелких объектов. 
YOLOv3 (2018) 
• Вводит мультискейловые предсказания (3 уровня feature 
maps). 
• Бэкбон — Darknet-53 (глубокая, residual-связи). 
• Каждая точка feature map предсказывает bounding boxes + 
objectness + классы. 
• Использует логистическую активацию для objectness и 
классов. 
• No softmax, классы независимы (много-меточная 
классификация). 
• Итог: точнее, стабильнее, детектирует мелкие и крупные 
объекты одновременно, при этом сохраняет real-time скорость. 
6. Из чего состоит YOLOv3: backbone, neck, head — общая 
структура. 
1. Backbone — Darknet-53 
• Это feature extractor, извлекающий признаки из входного 
изображения. 
• Архитектура: 
o Основана на Residual Connections (как в ResNet), 53 
сверточных слоя. 
o Используются только Conv + BatchNorm + LeakyReLU, без 
fully connected. 
o Структура: блоки вида Conv → BN → LeakyReLU, с 
периодическим уменьшением разрешения (stride=2). 
• Выдаёт feature maps на разных уровнях (например, 13×13, 26×26, 
52×52). 
2. Neck 
• Цель — объединить признаки разных уровней (грубые + 
детальные). 
• Используется Feature Pyramid Network (FPN)-подобная 
структура: 
o Крупные карты признаков (низкого разрешения, высокая 
семантика) апсемплируются и конкатенируются с 
мелкими (высокого разрешения). 
o Это помогает детектировать объекты разных размеров. 
• Пример: 
o Upsample из 13×13 → concat с 26×26 feature map. 
o Upsample из 26×26 → concat с 52×52 feature map. 
3. Head 
• Это часть, где формируются предсказания (bounding boxes, 
objectness, классы). 
• На каждом уровне (13×13, 26×26, 52×52) YOLOv3 делает 
предсказания: 
o Каждая ячейка предсказывает 3 anchor boxes → итого 3×(B, 
x, y, w, h, obj, C). 
o Используются 1×1 conv для получения выходных тензоров. 
• Для каждого anchor: 
o (tx, ty, tw, th) → смещения, восстанавливающие 
реальные координаты бокса. 
o to → objectness score. 
o tc1..Cn → вероятности классов. 
7. Что делает Darknet-53 и чем он похож на ResNet? 
o Принимает входное изображение (например, 416×416×3). 
o Пропускает его через последовательность свёрточных блоков 
(Conv → BatchNorm → LeakyReLU). 
o Постепенно уменьшает пространственное разрешение и 
увеличивает глубину признаков. 
o В результате формирует feature maps разной глубины: 
o мелкие — содержат детали (для маленьких объектов), 
o глубокие — содержат контекст (для крупных объектов). 
o Эти карты используются Neck’ом и Head’ом для детекции на 
разных масштабах. 
�
� Почему похож на ResNet 
• Darknet-53 — вдохновлён ResNet, но проще и легче. 
• Он использует residual connections: 
y=F(x)+x  
где F(x) — выход свёрточных слоёв блока. 
• Это решает проблему vanishing gradients и позволяет обучать 
глубокую сеть (53 conv слоя). 
• Каждый residual block состоит из: 
o 1×1 Conv (уменьшает число каналов), 
o 3×3 Conv (извлекает признаки), 
o Skip connection между входом и выходом. 
�
� Ключевые отличия от ResNet 
Особенность 
Структура блоков 
Downsampling 
Normalization 
ResNet-50/101 
Bottleneck (1×1, 3×3, 1×1) 
MaxPool и Strided Conv 
BatchNorm 
Darknet-53 
1×1 и 3×3 Conv 
Только Strided Conv 
BatchNorm 
Активация 
ReLU 
LeakyReLU 
Fully connected 
слои 
Назначение 
Итог: 
Есть (в классификации) 
Нет (полностью conv) 
ImageNet-классификация Детекция (YOLOv3 
backbone) 
Darknet-53 — это глубокий сверточный экстрактор признаков с 
residual-блоками, сочетающий простоту архитектуры и эффективность 
ResNet. 
Он обеспечивает баланс между скоростью и качеством признаков, 
необходимых для real-time детекции. 
8. Как реализована мульти-scale детекция (три выхода, strides 
8/16/32)? 
YOLOv3 делает предсказания на трёх уровнях feature maps с 
разными stride (8, 16, 32), что соответствует: 
• крупным объектам — stride 32 (низкое разрешение feature map, 
13×13), 
• средним объектам — stride 16 (26×26), 
• мелким объектам — stride 8 (52×52). 
Таким образом, каждый уровень отвечает за разный масштаб 
объектов, что эквивалентно идее Feature Pyramid Network (FPN). 
�
� Архитектура трёх выходов 
1
️
⃣ Крупные объекты (stride=32, feature map 13×13) 
• Используются глубокие признаки из Darknet-53 (последний 
слой). 
• Содержат богатую семантику, но плохое пространственное 
разрешение. 
• Предсказывают 3 anchor box для крупных объектов. 
2
️
⃣ Средние объекты (stride=16, feature map 26×26) 
• Берётся feature map из промежуточного уровня backbone. 
• К нему добавляют апсемплированные признаки из 
предыдущего (глубокого) уровня. 
• Конкатенируются → проходят conv-блоки → выход. 
• Предсказывают 3 anchor box для объектов среднего размера. 
3
️
⃣ Мелкие объекты (stride=8, feature map 52×52) 
• Аналогично: берётся более ранний feature map, к нему 
добавляется upsample предыдущего (26×26) выхода. 
• Это даёт высокое пространственное разрешение → способность 
видеть мелкие объекты. 
• Предсказывают 3 anchor box для мелких объектов. 
�
� Что происходит технически 
1. Из Darknet-53 берут feature maps с трёх разных уровней (после 
слоёв с разными stride). 
2. Через блоки 1×1 conv + upsample + concat строят пирамиду 
признаков. 
3. Для каждого уровня применяют 1×1 conv → (B×(5+C)) каналов, 
где 
a. 5 = (tx, ty, tw, th, obj), 
b. C = число классов, 
c. B = число anchor box (обычно 3 на уровень). 
4. На каждом уровне YOLO делает свои независимые 
предсказания.